var Comment={_isPreviewOpen:true,_captchaEnabled:false,set_captchaEnabled:function(A){Comment._captchaEnabled=A},init:function(){$("#commentTabs > ul").tabs();$("#commentTabs").show();if($("#txtCommentBody").length>0){$("#lnkCommentPreview").click(function(){if(Comment._isPreviewOpen){$("#commentPreview").slideUp("normal");$("#lnkCommentPreview").text("pokaż podgląd");Comment._isPreviewOpen=false}else{$("#commentPreview").slideDown("normal");$("#lnkCommentPreview").text("ukryj podgląd");Comment._isPreviewOpen=true}});RichEditor.create($("#txtCommentBody"),$("#hidbody"),$("#commentPreview"))}$("#frmCommentSubmit").validate({rules:{commentBody:{required:true,maxlength:2048}},messages:{commentBody:{required:"Komentarz nie może być pusty.",maxlength:"Komentarz nie może przekraczać 2048 znaków."}},submitHandler:function(D){var C={dataType:"json",beforeSubmit:function(E,G,F){if(!Membership.get_isLoggedIn()){Membership.showLogin(false);return false}$("#commentMessage").text("").css("color","").hide();$U.disableInputs("#frmCommentSubmit",true);$U.showProgress("Publikacja komentarza...","#btnCommentSubmit")},success:function(E){$U.disableInputs("#frmCommentSubmit",false);$U.hideProgress();if(E.isSuccessful){$("#txtCommentBody").val("");$("#commentMessage").text("Dziękujemy za zamieszczenie komentarza. Pojawi się on wkrótce.").css("color","").show()}else{$("#commentMessage").text(E.errorMessage).css("color","#ff0000").show()}}};$(D).ajaxSubmit(C);return false},errorPlacement:function(C,D){B(D).text(C.text())},highlight:function(D,C){B($(D)).show()},unhighlight:function(D,C){B($(D)).hide()}});function B(D){var C=D.parents("p:first").find("span.error");if((C.length==0)&&(Membership.get_isLoggedIn())&&(Comment._captchaEnabled)){C=D.parents("div#recaptcha_area").find("span.error")}return C}if((Membership.get_isLoggedIn())&&(Comment._captchaEnabled)){var A=setInterval(function(){if(($("#recaptcha_area").length>0)&&($("#recaptcha_response_field").length>0)){$('<span class="error"></span>').appendTo("#recaptcha_area");$("#recaptcha_response_field").attr("title","Pole Captcha nie może być puste.").rules("add",{required:true});window.clearInterval(A)}},500)}$("#lnkCommentLogin").click(function(){Membership.showLogin(false)});$("#lnkCommentSignup").click(function(){Membership.showSignUp()})},dispose:function(){$("#lnkCommentLogin").unbind();$("#lnkCommentSignup").unbind();$("#lnkCommentPreview").unbind();$("#txtCommentBody").unbind()}};