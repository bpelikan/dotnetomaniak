var Membership={_isLoggedIn:!1,_logOutUrl:"",_minUserNameLength:3,_minPasswordLength:5,_redirectToPrevious:!1,_centerMeTimer:null,_getStoryUrl:"",_MembershipBox:"#membershipBox",_StoryEditorBox:"#storyEditorBox",_Box:"",get_isLoggedIn:function(){return Membership._isLoggedIn},set_isLoggedIn:function(n){Membership._isLoggedIn=n},set_logOutUrl:function(n){Membership._logOutUrl=n},set_minPasswordLength:function(n){Membership._minPasswordLength=n},set_getStoryUrl:function(n){Membership._getStoryUrl=n},init:function(){function n(n,t){t.css("border-color","#CE0000"),t.next("span.error").text(n.text()).css("display","block").css("width",parseInt(t.css("width"))-31)}function t(n){$(n).next("span.error").show()}function i(n){$(n).next("span.error").hide()}$.validator.addMethod("userName",function(n){return/^([a-zA-Z])[a-zA-Z_-]*[\w_-]*[\S]$|^([a-zA-Z])[0-9_-]*[\S]$|^[a-zA-Z]*[\S]$/.test(n)},"Nazwa użytkownika musi składać się ze znaków alfanumerycznych (plus '-','_') i zaczynać się literą."),$("#lnkLogin").click(function(){Membership.showLogin(!1)}),$("#lostPassword").click(function(){Membership.showLostPassword(!1)}),$("#lnkSignup, #lnkSignup2").click(function(){Membership.showSignUp()}),$("#lnkChangePassword").click(function(){Membership.showChangePassword()}),$("#lnkLogout").click(function(){Membership.logout()}),$("#membershipBox").keydown(function(n){n.keyCode===27&&Membership._hide(!1,Membership._MembershipBox)}),$("#membershipClose").bind("click",function(){Membership._hide(!1,Membership._MembershipBox)}),$("#frmOpenIdLogin").validate({rules:{identifier:"required"},messages:{identifier:"Pole Open ID nie może być puste."},errorPlacement:n,highlight:t,unhighlight:i}),$("#frmLogin").validate({rules:{userName:"required",password:"required"},messages:{userName:"Nazwa użytkownika jest wymagana.",password:"Hasło jest wymagane."},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$("#loginMessage").hide().text("").css("color",""),$U.disableInputs("#loginSection",!0),$U.showProgress("Walidacja...","#chkLoginRememberMe")},success:function(n){$U.disableInputs("#loginSection",!1),$U.hideProgress(),n.isSuccessful?(Membership._hide(!0,Membership._MembershipBox),window.location.reload()):($("#loginMessage").text(n.errorMessage).css({color:"#ff0000",display:"block"}),$U.focus("txtLoginUserName"))}};return $(n).ajaxSubmit(t),!1},errorPlacement:n,highlight:t,unhighlight:i}),$("#frmForgotPassword").validate({rules:{email:{required:!0,email:!0}},messages:{email:{required:"Email nie może być pusty.",email:"Niepoprawny adres e-mail."}},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$U.disableInputs("#loginSection",!0),$U.showProgress("Weryfikacja...","#txtForgotEmail")},success:function(n){$U.disableInputs("#loginSection",!1),$U.hideProgress(),n.isSuccessful?$U.messageBox("Hasło wysłane","Twoje nowe hasło zostało wysłane\r\n na twój adres e-mail.",!1,function(){Membership._hide(!0,Membership._MembershipBox)}):($("#forgotPasswordMessage").text(n.errorMessage).css({color:"#ff0000",display:"block"}),$U.focus("txtForgotEmail"))}};return $(n).ajaxSubmit(t),!1},errorPlacement:n,highlight:t,unhighlight:i}),$("#frmChangePassword").validate({rules:{oldPassword:"required",newPassword:{required:!0,minlength:Membership._minPasswordLength},confirmPassword:{required:!0,equalTo:"#txtChangeNewPassword"}},messages:{oldPassword:"Stare hasło nie może być puste",newPassword:{required:"Nowe hasło nie może być puste",minlength:"Nowe hasło nie może być krótsze niż "+Membership._minPasswordLength+" znaków."},confirmPassword:{required:"Potwierdzenie hasła nie może być puste",equalTo:"Hasła muszą się zgadzać."}},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$("#changePasswordMessage").hide().text("Changing...").css("color",""),$U.disableInputs("#changePasswordSection",!0),$U.showProgress("Zmiana...","#txtChangenConfirmPassword")},success:function(n){$U.disableInputs("#changePasswordSection",!1),$U.hideProgress(),n.isSuccessful?$U.messageBox("Hasło zmienione","Twoje hasło zostało zmienione.",!1,function(){Membership._hide(!0,Membership._MembershipBox)}):$("#changePasswordMessage").text(n.errorMessage).css({color:"#ff0000",display:"block"})}};return $(n).ajaxSubmit(t),!1},errorPlacement:n,highlight:t,unhighlight:i}),$("#frmSignup").validate({rules:{userName:{required:!0,minlength:Membership._minUserNameLength,userName:!0},password:{required:!0,minlength:Membership._minPasswordLength},email:{required:!0,email:!0}},messages:{userName:{required:"Nazwa użytkownika nie może być pusta.",minlength:"Nazwa użytkownika nie może być krótsza niż "+Membership._minUserNameLength+" znaki/-ów."},password:{required:"Hasło nie może być puste.",minlength:"Hasło nie może być krótsze niż "+Membership._minPasswordLength+" znaki/-ów."},email:{required:"Email nie może być pusty.",email:"Niepoprawny format adresu email."}},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$("#signupMessage").hide().text("Rejestracja...").css("color",""),$U.disableInputs("#signupSection",!0),$U.showProgress("Rejestracja...","#txtSignupEmail")},success:function(n){$U.disableInputs("#signupSection",!1),$U.hideProgress(),n.isSuccessful?$U.messageBox("Konto utworzone","Twoje konto zostało poprawnie utworzone. Proszę postępuj zgodnie z informacjami w mailu aby aktywować konto.",!1,function(){Membership._hide(!0,Membership._MembershipBox),window.location.reload()}):$("#signupMessage").text(n.errorMessage).css({color:"#ff0000",display:"block"})}};return $(n).ajaxSubmit(t),!1},errorPlacement:n,highlight:t,unhighlight:i}),$("#lnkChangeEmail").click(function(){$("#emailViewSection").hide(),$("#emailEditSection").show(),$U.focus("txtChangeEmail")}),$("#lnkCancelEmail").click(function(){$("#emailEditSection").hide(),$("#emailViewSection").show()}),$("#frmChangeEmail").validate({rules:{email:{required:!0,email:!0}},messages:{email:{required:"E-mail nie może być pusty.",email:"Niepoprawny format adresu."}},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$U.disableInputs("#emailEditSection",!0),$U.showProgress("Aktualizacja adresu...","#btnChangeEmail")},success:function(n){$U.disableInputs("#emailEditSection",!1),$U.hideProgress(),n.isSuccessful?($("#emailEditSection").hide(),$("#emailViewSection").show(),$("#spnEmail").text($("#txtChangeEmail").val())):($U.focus("txtChangeEmail"),$("#spnChangeEmailError").text(n.errorMessage).show())}};return $(n).ajaxSubmit(t),!1},errorPlacement:function(n){$("#spnChangeEmailError").text(n.text())},highlight:function(){$("#spnChangeEmailError").show()},unhighlight:function(){$("#spnChangeEmailError").hide()}}),$("#storyEditorBox").keydown(function(n){n.keyCode===27&&Membership._hide(!1,Membership._StoryEditorBox)}),$("#storyEditorClose").click(function(){Membership._hide(!1,Membership._StoryEditorBox)}),$("#frmStoryUpdate").validate({rules:{name:"required",createdAt:"required",description:{required:!0,rangelength:[8,2048]},category:"required",tags:"required"},messages:{name:"Nazwa nie może być pusta.",createdAt:"Pole Utworzono nie może być puste.",title:{required:"Tytuł nie może być pusty.",maxlength:"Tytuł nie może być dłuższy niż 256 znaków."},description:{required:"Opis nie może być pusty.",rangelength:"Opis musi zawierać się pomiędzy 8 a 2048 znakami."},category:"Kategoria musi być wybrana.",tags:"Podaj przynajmniej jeden tag dla artykułu."},submitHandler:function(n){var t={dataType:"json",beforeSubmit:function(){$("#updateStoryMessage").text("").css("color","").hide(),$U.disableInputs("#frmStoryUpdate",!0),$U.showProgress("Aktualizacja wpisu...","#btnUpdateStory")},success:function(n){$U.disableInputs("#frmStoryUpdate",!1),$U.hideProgress(),n.isSuccessful?Membership._hide(!0,Membership._StoryEditorBox):$("#updateStoryMessage").text(n.errorMessage).css({color:"#ff0000",display:"block"})}};$(n).ajaxSubmit(t)},errorPlacement:function(n,t){t.parents("p:first").find("span.error").text(n.text())},highlight:function(n){$(n).parents("p:first").find("span.error").show()},unhighlight:function(n){$(n).parents("p:first").find("span.error").hide()}})},dispose:function(){Membership._clearCenterMeTimer(),$("#membershipBox").unbind(),$("#membershipClose").unbind(),$("#lnkLogin").unbind(),$("#lnkSignup").unbind(),$("#lnkSignup2").unbind(),$("#lnkChangePassword").unbind(),$("#lnkLogout").unbind(),$("#lostPasswordSection").unbind(),$("#storyEditorBox").unbind()},showLostPassword:function(n){Membership._redirectToPrevious=n,$(".contentContainer > div").hide(),$("#lostPasswordSection").show(),Membership._show(Membership._MembershipBox)},showLogin:function(n){Membership._redirectToPrevious=n,$(".contentContainer > div").hide(),$("#loginSection").show(),Membership._show(Membership._MembershipBox),$U.focus("txtOpenId")},showChangePassword:function(){$(".contentContainer > div").hide(),$("#changePasswordSection").show(),Membership._show(Membership._MembershipBox),$U.focus("txtChangeOldPassword")},showSignUp:function(){Membership._redirectToPrevious=!1,$(".contentContainer > div").hide(),$("#signupSection").show(),$("#changePasswordSection").show(),Membership._show(Membership._MembershipBox),$U.focus("txtSignupUserName")},logout:function(){$.ajax({url:Membership._logOutUrl,type:"POST",dataType:"json",data:"__MVCASYNCPOST=true",success:function(n){n.isSuccessful?window.location.reload():$U.alert("Error",n.errorMessage,!0)}})},_show:function(n){$U.blockUI();var t=$(n);$U.center(t),t.fadeIn(),Membership._centerMe(n),t.find("input").each(function(){var t=$(this)[0],n=t.type.toLowerCase();n=="text"||n=="file"||n=="password"?t.value="":(n=="checkbox"||n=="radio")&&(t.checked=!1)}),$("span.error").hide(),$("span.message").hide()},_hide:function(n,t){$U.disableInputs(t,!1),$U.hideProgress(),Membership._clearCenterMeTimer(),$(t).fadeOut("normal",function(){$U.unblockUI(),!n&&Membership._redirectToPrevious&&(window.location=document.referrer.length>0?document.referrer:"/")})},_centerMe:function(n){var t=$(n);$U.center(t),Membership._clearCenterMeTimer(),Membership._centerMeTimer=setInterval(function(){Membership._centerMe(n)},2e3)},_clearCenterMeTimer:function(){Membership._centerMeTimer!=null&&(clearInterval(Membership._centerMeTimer),Membership._centerMeTimer=null)},editStory:function(n){var t="id="+encodeURIComponent(n);$U.disableInputs("#frmStoryUpdate",!0),$.ajax({url:Membership._getStoryUrl,type:"POST",dataType:"json",data:t,beforeSend:function(){$U.showProgress("Wczytywanie artykułu...")},success:function(n){if($U.hideProgress(),$U.disableInputs("#frmStoryUpdate",!1),n.errorMessage)$U.messageBox("Error",n.errorMessage,!0);else{$U.blockUI();var t=$("#storyEditorBox");$("span.error").hide(),$("span.message").hide(),$("#hidStoryId").val(n.id),$("#txtStoryName").val(n.name),$("#txtStoryCreatedAt").val(n.createdAt),$("#txtStoryTitle").val(n.title),$("#txtStoryDescription").val(n.description),$("#txtStoryTags").val(n.tags),$("#frmStoryUpdate input[type=radio]").each(function(){var t=$(this)[0];t.value==n.category&&(t.checked=!0)}),$U.center(t),t.fadeIn(),Membership._centerMe("#storyEditorBox")}}})}};
//@ sourceMappingURL=Membership.min.js.map