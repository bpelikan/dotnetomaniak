var Moderation = { _markCommentAsOffendedUrl: "", _spamCommentUrl: "", _deleteStoryUrl: "", _spamStoryUrl: "", _approveStoryUrl: "", _getStoryUrl: "", _generateMiniatureStoryUrl: "", _centerMeTimer: null, set_markCommentAsOffendedUrl: function (n) { Moderation._markCommentAsOffendedUrl = n }, set_spamCommentUrl: function (n) { Moderation._spamCommentUrl = n }, set_deleteStoryUrl: function (n) { Moderation._deleteStoryUrl = n }, set_spamStoryUrl: function (n) { Moderation._spamStoryUrl = n }, set_approveStoryUrl: function (n) { Moderation._approveStoryUrl = n }, set_getStoryUrl: function (n) { Moderation._getStoryUrl = n }, set_generateMiniatureStoryUrl: function (n) { Moderation._generateMiniatureStoryUrl = n }, init: function () { $("#storyEditorBox").keydown(function (n) { n.keyCode === 27 && Moderation._hide() }), $("#storyEditorClose").click(function () { Moderation._hide() }), $("#frmStoryUpdate").validate({ rules: { name: "required", createdAt: "required", description: { required: !0, rangelength: [8, 2048] }, category: "required", tags: "required" }, messages: { name: "Nazwa nie mo¿e byæ pusta.", createdAt: "Pole Utworzono nie mo¿e byæ puste.", title: { required: "Tytu³ nie mo¿e byæ pusty.", maxlength: "Tytu³ nie mo¿e byæ d³u¿szy ni¿ 256 znaków." }, description: { required: "Opis nie mo¿e byæ pusty.", rangelength: "Opis musi zawieraæ siê pomiêdzy 8 a 2048 znakami." }, category: "Kategoria musi byæ wybrana.", tags: "Podaj przynajmniej jeden tag dla artyku³u." }, submitHandler: function (n) { var t = { dataType: "json", beforeSubmit: function () { $("#updateStoryMessage").text("").css("color", "").hide(), $U.disableInputs("#frmStoryUpdate", !0), $U.showProgress("Aktualizacja wpisu...", "#btnUpdateStory") }, success: function (n) { $U.disableInputs("#frmStoryUpdate", !1), $U.hideProgress(), n.isSuccessful ? Moderation._hide() : $("#updateStoryMessage").text(n.errorMessage).css({ color: "#ff0000", display: "block" }) } }; $(n).ajaxSubmit(t) }, errorPlacement: function (n, t) { t.parents("p:first").find("span.error").text(n.text()) }, highlight: function (n) { $(n).parents("p:first").find("span.error").show() }, unhighlight: function (n) { $(n).parents("p:first").find("span.error").hide() } }) }, dispose: function () { }, editStory: function (n) { var t = "id=" + encodeURIComponent(n); $U.disableInputs("#frmStoryUpdate", !0), $.ajax({ url: Moderation._getStoryUrl, type: "POST", dataType: "json", data: t, beforeSend: function () { $U.showProgress("Wczytywanie artyku³u...") }, success: function (n) { if ($U.hideProgress(), $U.disableInputs("#frmStoryUpdate", !1), n.errorMessage) $U.messageBox("Error", n.errorMessage, !0); else { $U.blockUI(); var t = $("#storyEditorBox"); $("span.error").hide(), $("span.message").hide(), $("#hidStoryId").val(n.id), $("#txtStoryName").val(n.name), $("#txtStoryCreatedAt").val(n.createdAt), $("#txtStoryTitle").val(n.title), $("#txtStoryDescription").val(n.description), $("#txtStoryTags").val(n.tags), $("#frmStoryUpdate input[type=radio]").each(function () { var t = $(this)[0]; t.value == n.category && (t.checked = !0) }), $U.center(t), t.fadeIn(), Moderation._centerMe() } } }) }, approveStory: function (n) { function t() { var t = "id=" + encodeURIComponent(n); $.ajax({ url: Moderation._approveStoryUrl, type: "POST", dataType: "json", data: t, beforeSend: function () { $U.showProgress("Zatwierdzanie wpisu...") }, success: function (t) { $U.hideProgress(), t.isSuccessful ? $("#t-" + n).fadeOut("normal", function () { $(this).remove() }) : $U.messageBox("Error", t.errorMessage, !0) } }) } $U.confirm("ZatwierdŸ artyku³?", "Czy jesteœ pewny, ¿e chcesz zatwierdziæ dany artyku³?", t) }, deleteStory: function (n) { function t() { var t = "id=" + encodeURIComponent(n); $.ajax({ url: Moderation._deleteStoryUrl, type: "POST", dataType: "json", data: t, beforeSend: function () { $U.showProgress("Usuwanie artyku³u...") }, success: function (t) { $U.hideProgress(), t.isSuccessful ? $("#t-" + n).fadeOut("normal", function () { $(this).remove() }) : $U.messageBox("Error", t.errorMessage, !0) } }) } $U.confirm("Usuniêcie artyku³u?", "Czy jesteœ pewny, ¿e chcesz usunaæ dany artyku³?", t) }, confirmSpamStory: function (n) { function t() { var t = "id=" + encodeURIComponent(n); $.ajax({ url: Moderation._spamStoryUrl, type: "POST", dataType: "json", data: t, beforeSend: function () { $U.showProgress("Zatwierdzanie spamowego artyku³u...") }, success: function (t) { $U.hideProgress(), t.isSuccessful ? $("#t-" + n).fadeOut("normal", function () { $(this).remove() }) : $U.messageBox("Error", t.errorMessage, !0) } }) } $U.confirm("Oznacz jako spam?", "Czy na pewno chcesz oznaczyæ artyku³ jako spam?", t) }, generateMiniatureStory: function (n) { function t() { var t = "id=" + encodeURIComponent(n); $.ajax({ url: Moderation._generateMiniatureStoryUrl, type: "POST", dataType: "json", data: t, beforeSend: function () { $U.showProgress("Generowanie miniatury") }, success: function (n) { $U.hideProgress(), n.isSuccessful ? $(".entry-thumb img").attr("src", n.url) : $U.messageBox("Error", n.errorMessage, !0) } }) } $U.confirm("Generowanie miniaturki", "Czy jesteœ pewny, ¿e chcesz pobraæ miniaturkê?", t) }, confirmSpamComment: function (n, t) { function i() { var i = { storyId: n, commentId: t }; $.ajax({ url: Moderation._spamCommentUrl, type: "POST", dataType: "json", data: i, beforeSend: function () { $U.showProgress("Zatwierdzanie spamowego komentarza...") }, success: function (n) { $U.hideProgress(), n.isSuccessful ? $("#li-" + t).fadeOut("normal", function () { $(this).remove() }) : $U.messageBox("Error", n.errorMessage, !0) } }) } $U.confirm("Zatwierdziæ spamowy komentarz?", "Jesteœ pewien, ¿e chcesz zatwierdziæ komentarz jako spamowy?", i) }, markCommentAsOffended: function (n, t) { function i() { var i = { storyId: n, commentId: t }; $.ajax({ url: Moderation._markCommentAsOffendedUrl, type: "POST", dataType: "json", data: i, beforeSend: function () { $U.showProgress("Zaznaczanie jako obraŸliwy...") }, success: function (n) { $U.hideProgress(), n.isSuccessful ? $U.messageBox("Sukces", "Komentarz zosta³ oznaczony jako obraŸliwy.", !1) : $U.messageBox("B³¹d", n.errorMessage, !0) } }) } $U.confirm("ObraŸliwy?", "Jesteœ pewien, ¿e chcesz zaznaczyæ komenatrz jako obraŸliwy?", i) }, _hide: function () { $U.disableInputs("#storyEditorBox", !1), $U.hideProgress(), Moderation._clearCenterMeTimer(), $("#storyEditorBox").fadeOut("normal", function () { $U.unblockUI() }) }, _centerMe: function () { var n = $("#storyEditorBox"); $U.center(n), Moderation._clearCenterMeTimer(), Moderation._centerMeTimer = setInterval(function () { Moderation._centerMe() }, 2e3) }, _clearCenterMeTimer: function () { Moderation._centerMeTimer != null && (clearInterval(Moderation._centerMeTimer), Moderation._centerMeTimer = null) } }